<!-- src/main/resources/templates/admin/raid-scenarios.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>λ μ΄λ“ μ„ΈνΈ κ΄€λ¦¬</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #111827;
      color: #e5e7eb;
      margin: 0;
      padding: 24px;
    }

    h1, h2 {
      margin: 0 0 16px 0;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .top-bar a {
      color: #93c5fd;
      text-decoration: none;
      font-size: 14px;
    }

    .card {
      background: #1f2937;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
      margin-bottom: 24px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px 24px;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .form-row label {
      font-size: 13px;
      color: #9ca3af;
    }

    .form-row input,
    .form-row textarea,
    .form-row select {
      border-radius: 8px;
      border: 1px solid #374151;
      background: #030712;
      color: #e5e7eb;
      padding: 8px 10px;
      font-size: 14px;
    }

    .form-row textarea {
      resize: vertical;
      min-height: 60px;
    }

    .btn-row {
      margin-top: 16px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .btn {
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 14px;
      border: none;
      cursor: pointer;
    }

    .btn-primary {
      background: #3b82f6;
      color: white;
    }

    .btn-primary:hover {
      background: #2563eb;
    }

    .btn-ghost {
      background: transparent;
      color: #9ca3af;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    thead {
      background: #111827;
    }

    th, td {
      padding: 8px 10px;
      border-bottom: 1px solid #374151;
      text-align: left;
    }

    th {
      font-weight: 500;
      color: #9ca3af;
    }

    tbody tr:hover {
      background: #111827;
    }

    .badge {
      display: inline-block;
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 11px;
      background: #111827;
      color: #93c5fd;
    }

    .room-id {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      color: #9ca3af;
    }

    .empty {
      text-align: center;
      padding: 16px 0;
      color: #6b7280;
    }
  </style>
</head>
<body>
<div class="page">
  <div class="top-bar">
    <h1>λ μ΄λ“ μ„ΈνΈ κ΄€λ¦¬</h1>
    <a th:href="@{/admin}">β† κ΄€λ¦¬μ ν™μΌλ΅</a>
  </div>

  <!-- μƒ μ„ΈνΈ μƒμ„± μΉ΄λ“ -->
  <div class="card">
    <div class="card-title">μƒ λ μ΄λ“ μ„ΈνΈ μƒμ„±</div>

    <!-- AdminRaidScenarioControllerμ—μ„ λ„κ²¨μ£Όλ” form / bosses μ‚¬μ© -->
    <form th:action="@{/admin/raids/new}" th:object="${form}" method="post">
      <div class="form-grid">
        <div class="form-row">
          <label>μ„ΈνΈ μ΄λ¦„</label>
          <input type="text" th:field="*{name}" placeholder="μ) νν† λ¦¬μ–Ό λ μ΄λ“" required>
        </div>

        <div class="form-row">
          <label>λ³΄μ¤ μ„ νƒ (λ³΄μ¤ DB)</label>
          <select th:field="*{bossId}" required>
            <option th:if="${#lists.isEmpty(bosses)}" value="">λ“±λ΅λ λ³΄μ¤κ°€ μ—†μµλ‹λ‹¤.</option>
            <option th:unless="${#lists.isEmpty(bosses)}" value="">λ³΄μ¤λ¥Ό μ„ νƒν•μ„Έμ”</option>
            <option th:each="b : ${bosses}"
                    th:value="${b.id}"
                    th:text="${b.id + ' - ' + b.name + ' (HP ' + b.maxHp + ')'}">
            </option>
          </select>
        </div>

        <div class="form-row" style="grid-column: 1 / -1;">
          <label>μ„¤λ…</label>
          <textarea th:field="*{description}" placeholder="λ μ΄λ“μ— λ€ν• μ„¤λ…μ„ μ μ–΄μ£Όμ„Έμ”."></textarea>
        </div>
      </div>

      <div class="btn-row">
        <button type="submit" class="btn btn-primary">μ„ΈνΈ μƒμ„±</button>
      </div>
    </form>
  </div>

  <!-- μ„ΈνΈ λ©λ΅ μΉ΄λ“ -->
  <div class="card">
    <div class="card-title">λ“±λ΅λ λ μ΄λ“ μ„ΈνΈ</div>

    <table>
      <thead>
      <tr>
        <th style="width: 60px;">ID</th>
        <th>μ„ΈνΈ μ΄λ¦„</th>
        <th style="width: 180px;">λ³΄μ¤</th>
        <th>μ„¤λ…</th>
        <th style="width: 160px;">Lobby Room</th>
        <th style="width: 160px;">Raid Room</th>
        <!-- π”¥ μ—¬κΈ° μ¶”κ°€ -->
        <th style="width: 80px;">μƒνƒ</th>
        <th style="width: 140px;">κ΄€λ¦¬</th>
      </tr>
      </thead>
      <tbody>
      <tr th:if="${#lists.isEmpty(scenarios)}">
        <td colspan="6" class="empty">μ•„μ§ λ“±λ΅λ λ μ΄λ“ μ„ΈνΈκ°€ μ—†μµλ‹λ‹¤.</td>
      </tr>

      <tr th:each="sc : ${scenarios}">
        <td th:text="${sc.id}"></td>
        <td>
          <span th:text="${sc.name}"></span>
          <!-- RaidScenarioμ— getBossName()μ΄ μλ‹¤κ³  κ°€μ • -->
          <span class="badge" th:if="${sc.bossName != null}"
                th:text="${'Boss: ' + sc.bossName}"></span>
        </td>
        <td>
          <!-- bossName / boss μ •λ³΄ ν‘μ‹ -->
          <div th:text="${sc.bossName != null ? sc.bossName : '(λ³΄μ¤ λ―Έμ§€μ •)'}"></div>
          <div class="room-id"
               th:text="${sc.boss != null ? '(ID: ' + sc.boss.id + ', HP: ' + sc.boss.maxHp + ')' : ''}">
          </div>
        </td>
        <td th:text="${sc.description}">-</td>
        <td class="room-id" th:text="${'lobby-' + sc.id}"></td>
        <td class="room-id" th:text="${'raid-' + sc.id}"></td>

        <!-- π”¥ μƒνƒ -->
        <td>
    <span class="badge"
          th:if="${sc.active}"
          style="background:#022c22; color:#6ee7b7;">
      ACTIVE
    </span>
          <span class="badge"
                th:if="${!sc.active}"
                style="background:#3f1d1d; color:#fecaca;">
      INACTIVE
    </span>
        </td>

        <!-- π”¥ κ΄€λ¦¬ λ²„νΌ -->
        <td>
          <form th:if="${sc.active}"
                th:action="@{|/admin/raids/${sc.id}/deactivate|}"
                method="post"
                style="display:inline;">
            <button type="submit" class="btn btn-ghost">λΉ„ν™μ„±ν™”</button>
          </form>

          <form th:if="${!sc.active}"
                th:action="@{|/admin/raids/${sc.id}/activate|}"
                method="post"
                style="display:inline;">
            <button type="submit" class="btn btn-ghost">ν™μ„±ν™”</button>
          </form>

          <!-- μ§„μ§ μ‚­μ  λ²„νΌλ„ μ›ν•λ©΄ μ•„λ μ¶”κ°€ (μ„ νƒ) -->
          <form th:action="@{|/admin/raids/${sc.id}/delete|}"
                method="post"
                style="display:inline;"
                onsubmit="return confirm('μ •λ§ μ‚­μ ν• κΉμ”?');">
            <button type="submit" class="btn btn-ghost">μ‚­μ </button>
          </form>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
      </body>
      </html>
