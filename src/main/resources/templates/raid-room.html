<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Boss Raid</title>
    <link rel="stylesheet" th:href="@{/css/raid-room.css}">
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <script src="/js/global.js" defer></script>
</head>
<body>

<div class="top-bar">
    <span th:text="'Player: ' + ${username}"></span>
    <span th:if="${character != null}"
          th:text="' | Character: ' + ${character.name}"></span>
    <span th:text="' | Raid: ' + ${scenario.name}"></span>
    <span th:if="${scenario.bossName != null}"
          th:text="' | Boss: ' + ${scenario.bossName}"></span>

    <!-- üî• ADMIN Ï†ÑÏö© Ï†ÑÌà¨ ÏãúÏûë Î≤ÑÌäº -->
    <button id="admin-start-btn"
            th:if="${isAdmin}"
            class="admin-start-btn">
        Ï†ÑÌà¨ ÏãúÏûë
    </button>

    <!-- üî• ÏóîÎî© ÌõÑ ÌôúÏÑ±ÌôîÎê† Î°úÎπÑ Î≤ÑÌäº -->
    <button id="back-to-lobby-btn"
            class="back-to-lobby-btn"
            th:onclick="|location.href='@{/lobby}'|"
            disabled>
        Î°úÎπÑÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
    </button>
</div>

<div class="raid-container">

    <!-- ===== LEFT: Î≥¥Ïä§ & ÌååÌã∞ ===== -->
    <div class="raid-left">
        <!-- Î≥¥Ïä§ ÏòÅÏó≠ -->
        <div class="boss-area">
            <div class="boss-header">
                <div class="boss-main-info">
                    <div class="section-title">Boss</div>

                    <div class="boss-name-row">
                        <div class="boss-name" id="boss-name"
                             th:text="${bossName}">Dark Dragon</div>

                        <!-- üî• Î≥¥Ïä§ AP ÌëúÏãú -->
                        <div class="boss-ap" id="boss-ap-text">
                            AP 0
                        </div>
                    </div>
                </div>

                <!-- üî• Î≥¥Ïä§ Ïä§ÌÇ¨ Ïä¨Î°Ø 3Í∞ú -->
                <div class="boss-skill-list">

                    <!-- skill1 -->
                    <div class="boss-skill-slot" data-skill-index="1">
                        <div class="boss-skill-icon skill-1"></div>

                        <!-- Ïø®ÌÉÄÏûÑ Ïò§Î≤ÑÎ†àÏù¥ (Í∏∞Î≥∏: Î≥¥ÏûÑ / ÎÇòÏ§ëÏóê JSÎ°ú Í∞í Í∞±Ïã†) -->
                        <div class="boss-skill-overlay">
                            <span class="cooldown-number" id="boss-skill1-cd">2</span>
                        </div>

                        <!-- Ìà¥ÌåÅ: Ïù¥Î¶Ñ + ÏÑ§Î™Ö (ÎÇòÏ§ëÏóê ÏÑúÎ≤Ñ/JSÏóêÏÑú ÌÖçÏä§Ìä∏ Ï£ºÏûÖ Í∞ÄÎä•) -->
                        <div class="boss-skill-tooltip">
                            <strong id="boss-skill1-name">Ïä§ÌÇ¨1</strong>
                            <p id="boss-skill1-desc">Ïä§ÌÇ¨1 ÏÑ§Î™Ö</p>
                        </div>
                    </div>

                    <!-- skill2 -->
                    <div class="boss-skill-slot" data-skill-index="2">
                        <div class="boss-skill-icon skill-2"></div>
                        <div class="boss-skill-overlay">
                            <span class="cooldown-number" id="boss-skill2-cd">1</span>
                        </div>
                        <div class="boss-skill-tooltip">
                            <strong id="boss-skill2-name">Ïä§ÌÇ¨2</strong>
                            <p id="boss-skill2-desc">Ïä§ÌÇ¨2 ÏÑ§Î™Ö</p>
                        </div>
                    </div>

                    <!-- skill3 (ÏòàÎπÑ / ÏïÑÏßÅ Ïïà Ïç®ÎèÑ Îê®) -->
                    <div class="boss-skill-slot" data-skill-index="3">
                        <div class="boss-skill-icon skill-3"></div>
                        <div class="boss-skill-overlay">
                            <span class="cooldown-number" id="boss-skill3-cd">3</span>
                        </div>
                        <div class="boss-skill-tooltip">
                            <strong id="boss-skill3-name">Ïä§ÌÇ¨3</strong>
                            <p id="boss-skill3-desc">Ïä§ÌÇ¨3 ÏÑ§Î™Ö</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Í∏∞Ï°¥ HP Î∞îÎäî Í∑∏ÎåÄÎ°ú ÏïÑÎûòÏóê -->
            <div class="hp-bar-wrapper">
                <div class="hp-bar-fill" id="boss-hp-bar"></div>
            </div>
            <div class="hp-text" id="boss-hp-text"
                 th:text="${'HP ' + bossCurrentHp + ' / ' + bossMaxHp}">
                HP 7000 / 10000 (70%)
            </div>
        </div>


        <!-- ÌååÌã∞ ÏòÅÏó≠ -->
        <div class="party-area">
            <div class="section-title">Party</div>

            <div th:each="member : ${partyMembers}" class="character-row">
                <div class="character-name">
                    <span th:text="${member.name}">Player1</span>
                    <!-- üî• AP ÌëúÏãú -->
                    <span class="char-ap-text"
                          th:text="${'AP ' + member.ap}">
            AP 0
        </span>
                </div>
                <div class="char-hp-wrapper">
                    <div class="char-hp-fill"
                         th:attr="style=|width: ${member.hpRatio}%|"></div>
                </div>
                <div class="char-hp-text"
                     th:text="${member.hp} + ' / ' + ${member.maxHp}">
                    100 / 100
                </div>
            </div>
        </div>
    </div>

    <!-- ===== RIGHT: Ï±ÑÌåÖ ===== -->
    <div class="raid-right">
        <div class="chat-header">Raid Chat</div>
        <div id="chat-status" class="chat-status">Ïó∞Í≤∞ ÎåÄÍ∏∞Ï§ë...</div>

        <div class="chat-window"
             id="chat-window"
             th:attr="data-username=${username}, data-room-id=${roomId}">
        </div>

        <div class="chat-input-area">
            <input id="chat-input"
                   type="text"
                   placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
            <button id="chat-send-btn">Î≥¥ÎÇ¥Í∏∞</button>
        </div>

        <div class="action-row">
            <label>
                <input type="radio" name="action-mode" value="CHAT" checked>
                üí¨ Ï±ÑÌåÖ
            </label>
            <label>
                <input type="radio" name="action-mode" value="ATTACK">
                üó° Í≥µÍ≤©
            </label>
            <label>
                <input type="radio" name="action-mode" value="DEFEND">
                üõ° Î∞©Ïñ¥
            </label>

            <select id="defend-target-select" disabled>
                <option value="">Î∞©Ïñ¥ ÎåÄÏÉÅ ÏÑ†ÌÉù</option>
                <!-- PARTY_UPDATE Î∞õÏùÑ Îïå Ïó¨Í∏∞ ÏòµÏÖò Ï±ÑÏõÄ -->
            </select>
        </div>
    </div>

</div>

<!-- Î†àÏù¥Îìú ÏûÖÏû• Ïãú ÌéòÏù¥Îìú ÏïÑÏõÉÏö© Ïò§Î≤ÑÎ†àÏù¥ -->
<div id="raid-entry-overlay" class="raid-entry-overlay show">
    <div class="raid-entry-title" id="raid-entry-title"
         th:text="${scenario.name}">Î†àÏù¥Îìú Ïù¥Î¶Ñ</div>
    <div class="raid-entry-desc" id="raid-entry-desc"
         th:text="${scenario.description}">Î†àÏù¥Îìú ÏÑ§Î™Ö</div>
</div>


<script th:src="@{/js/raid-room.js}"></script>
</body>
</html>
